<%= cl_image_tag @club.photo, class: "avatar-bordered" %>
<h2><%= @club.name %></h2>
<p><%= @club.address %></p>
<p>
  <% @club.offers.each do |offer| %>
    <span><%= offer.sport.name %></span>
  <% end %>
</p>
<p><%= @club.description %></p>
<% @membership = Membership.where(user_id: current_user.id, club_id: @club.id) %>
<% if @membership == [] %>
  <%= simple_form_for [@club, @membership = Membership.new] do |f| %>
    <%= f.hidden_field :status, value: "Pending" %>
    <%= f.submit "Add to Memberships", class:"btn-confirm"%>
  <% end %>
<% elsif @membership[0].status == "Member" %>
  <div class="alert alert-success"><p>You are a Memberhip of this Club!</p></div>
<% else %>
  <div class="alert alert-warning"><p>Your Memberhip-Request is getting processed</p></div>
<% end %>
<%= link_to "All Clubs", clubs_path, class: "btn-confirm" %>

<div class="d-flex align-items-center">
<h2><%= @club.name %></h2>
          <% ratings = [] %>
          <% @club.reviews.each do |ra| %>
            <% ratings << ra.rating.to_i %>
          <% end %>
          <% if ratings.size != 0 %>
            <% rating = ratings.sum / ratings.size unless ratings.size == 0 %>
            <% rating.times do  %>
            <span><i class="fas fa-star"></i></span>
            <% end %>
            <% end %>
</div>
<h3><%= pluralize @club.reviews.size, "review" %></h3>

<div id="reviews">
  <% if @club.reviews.blank? %>
    <p>Be the first to leave a review for <%= @club.name %></p>
  <% else %>
    <% @club.reviews.each do |review| %>
      <div class="d-flex align-items-center">
        <p><strong>Name:</strong> <%= review.user.name %></p>
        <p><strong>Comment:</strong><%= review.comment %></p>
        <p><strong>Rating:</strong>
          <% review.rating.times do  %>
            <span><i class="fas fa-star"></i></span>
          <% end %>
        </p>
      </div>
    <% end %>
  <% end %>
</div>
<%= simple_form_for [ @club, Review.new ], remote: true do |f| %>
  <%= f.input :rating, collection: [ 1, 2, 3, 4, 5 ] %>
  <%= f.input :comment, as: :text %>
  <%= f.submit "Send the review", class: 'btn-confirm' %>
<% end %>

